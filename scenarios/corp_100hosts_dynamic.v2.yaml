# Scenario with 100 hosts, v2 format with per-item probabilities for services/processes

subnets: [6-8, 6-8, 6-8, 6-8, 6-8, 6-8, 6-8, 6-8, 6-8, 6-8, 6-8, 6-8]  # 12 subnets with 6-8 hosts each (min 72, max 96)
address_space_bounds: (13, 10)
topology: [[ 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
           [ 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
           [ 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
           [ 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0],
           [ 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0],
           [ 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0],
           [ 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0],
           [ 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0],
           [ 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0],
           [ 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1],
           [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0],
           [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1],
           [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1]]
subnet_labels:
  1: DMZ
  2: user
  3: service
  4: db
  5: dev
  6: app
  7: app2
  8: app3
  9: web
  10: office
  11: research
  12: backups

# Probability that a host in a given subnet is sensitive (value fixed inside loader)
sensitive_hosts:
  1: 0.0  # DMZ
  2: 0.0  # user
  3: 0.6  # service
  4: 1.0  # db
  5: 0.2  # dev
  6: 0.3  # app
  7: 0.3  # app2
  8: 0.4  # app3
  9: 0.5  # web
  10: 0.2 # office
  11: 0.5 # research
  12: 0.8 # backups

os:
  - linux
  - windows

# Extended service catalog (v2 style: port_os_name)
services:
  - 22_linux_ssh
  - 23_linux_telnet
  - 21_linux_vsftpd
  - 25_linux_smtp_exim
  - 389_linux_ldap
  - 2049_linux_nfs
  - 445_linux_samba
  - 5432_linux_postgres
  - 27017_linux_mongodb
  - 6379_linux_redis
  - 11211_linux_memcached
  - 5601_linux_kibana
  - 3000_linux_grafana
  - 8080_linux_tomcat_mgr
  - 8081_linux_jenkins
  - 8161_linux_activemq
  - 5900_linux_vnc
  - 69_linux_tftp
  - 53_linux_dns_bind
  - 80_linux_joomla
  - 80_linux_moodle
  - 80_linux_mediawiki
  - 80_linux_phpmyadmin
  - 3306_any_mysql
  - 445_windows_smb
  - 3389_windows_rdp
  - 5985_windows_winrm
  - 135_windows_msrpc
  - 88_windows_kerberos
  - 389_windows_ldap_ad
  - 1433_windows_mssql
  - 80_windows_iis

# Services that should appear more often on sensitive hosts
sensitive_services:
  - 3306_any_mysql
  - 5432_linux_postgres
  - 1433_windows_mssql

# Extended process catalog (ensure second token is OS for loader's filter)
processes:
  - p_linux_polkit_pkexec
  - p_linux_sudo_misconfig
  - p_linux_suid_bin
  - p_linux_cron_root
  - p_linux_docker_sock
  - p_linux_kernel_dirty_pipe
  - p_windows_spooler
  - p_windows_unquoted_service_path
  - p_windows_weak_service_perms
  - p_windows_se_impersonate
  - p_windows_uac_bypass
  - p_windows_dll_hijack
  - p_windows_vuln_driver

# Optional probability maps used by enhanced loaders (ignored by current loader if unmodified)
service_probabilities:
  22_linux_ssh: 0.9
  23_linux_telnet: 0.1
  21_linux_vsftpd: 0.85
  25_linux_smtp_exim: 0.85
  389_linux_ldap: 0.85
  2049_linux_nfs: 0.85
  445_linux_samba: 0.9
  5432_linux_postgres: 0.9
  27017_linux_mongodb: 0.85
  6379_linux_redis: 0.85
  11211_linux_memcached: 0.85
  5601_linux_kibana: 0.2
  3000_linux_grafana: 0.2
  8080_linux_tomcat_mgr: 0.85
  8081_linux_jenkins: 0.2
  8161_linux_activemq: 0.2
  5900_linux_vnc: 0.85
  69_linux_tftp: 0.1
  53_linux_dns_bind: 0.9
  80_linux_joomla: 0.85
  80_linux_moodle: 0.2
  80_linux_mediawiki: 0.85
  80_linux_phpmyadmin: 0.85
  3306_any_mysql: 0.9
  445_windows_smb: 0.9
  3389_windows_rdp: 0.85
  5985_windows_winrm: 0.85
  135_windows_msrpc: 0.85
  88_windows_kerberos: 0.85
  389_windows_ldap_ad: 0.85
  1433_windows_mssql: 0.9
  80_windows_iis: 0.2

process_probabilities:
  p_linux_polkit_pkexec: 0.8
  p_linux_sudo_misconfig: 0.7
  p_linux_suid_bin: 0.2
  p_linux_cron_root: 0.25
  p_linux_docker_sock: 0.15
  p_linux_kernel_dirty_pipe: 0.1
  p_windows_spooler: 0.8
  p_windows_unquoted_service_path: 0.7
  p_windows_weak_service_perms: 0.2
  p_windows_se_impersonate: 0.15
  p_windows_uac_bypass: 0.15
  p_windows_dll_hijack: 0.1
  p_windows_vuln_driver: 0.1

# Exploits for a subset of services
exploits:
  e_vsftpd:
    service: 21_linux_vsftpd
    os: linux
    prob: 0.9
    cost: 1
    access: user
  e_tomcat_mgr:
    service: 8080_linux_tomcat_mgr
    os: linux
    prob: 0.8
    cost: 2
    access: user
  e_jenkins:
    service: 8081_linux_jenkins
    os: linux
    prob: 0.7
    cost: 2
    access: user
  e_smb_win:
    service: 445_windows_smb
    os: windows
    prob: 0.8
    cost: 2
    access: user
  e_rdp:
    service: 3389_windows_rdp
    os: windows
    prob: 0.6
    cost: 2
    access: user
  e_mysql:
    service: 3306_any_mysql
    os: none
    prob: 1.0
    cost: 1
    access: root
  e_mssql:
    service: 1433_windows_mssql
    os: windows
    prob: 0.8
    cost: 2
    access: user
  e_postgres:
    service: 5432_linux_postgres
    os: linux
    prob: 0.85
    cost: 2
    access: user

# Privilege escalation actions mapped to processes
privilege_escalation:
  pe_polkit:
    process: p_linux_polkit_pkexec
    os: linux
    prob: 0.8
    cost: 1
    access: root
  pe_polkit_any:
    process: p_linux_polkit_pkexec
    os: none
    prob: 0.7
    cost: 1
    access: root
  pe_sudo:
    process: p_linux_sudo_misconfig
    os: linux
    prob: 0.7
    cost: 1
    access: root
  pe_sudo_any:
    process: p_linux_sudo_misconfig
    os: none
    prob: 0.6
    cost: 1
    access: root
  pe_spooler:
    process: p_windows_spooler
    os: windows
    prob: 0.8
    cost: 1
    access: root
  pe_unquoted:
    process: p_windows_unquoted_service_path
    os: windows
    prob: 0.7
    cost: 1
    access: root


service_scan_cost: 1
os_scan_cost: 1
subnet_scan_cost: 1
process_scan_cost: 1

# Randomize host configs per episode, filtered by OS and skewed count distribution
host_configurations: _random

# Allow all inter-subnet communications along topology
firewall: _subnets

# Scan noise configuration for realism
scan_noise:
  service_scan:
    false_positive_rate: 0.05  # 5% chance of showing non-existent service
    false_negative_rate: 0.10  # 10% chance of missing real service
  os_scan:
    false_positive_rate: 0.02
    false_negative_rate: 0.05
  process_scan:
    false_positive_rate: 0.08
    false_negative_rate: 0.15 